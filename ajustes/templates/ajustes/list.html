{% extends "login/base-list.html" %}
{% load extra_filters %}

{% load staticfiles %}

{% block css %}
{{ block.super }}
{% endblock %}

{% block section_title %}Ajustes de Inventario{% endblock %}
{% block section_subtitle %}
<br />
    <div class="email-btn-row hidden-xs">
        <a href="{% url 'ajustes-create' %}" class="btn btn-sm btn-success"><i class="fa fa-plus m-r-5"></i> Nuevo Ajuste</a>
	</div>

					{% endblock %}

{% block content %}
				<!-- begin col-12 -->
				<div class="col-md-12">
					<!-- begin panel -->
					<div class="panel panel-inverse">
						<div class="panel-heading">
							<div class="panel-heading-btn">
								<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
								<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
							</div>
							<h4 class="panel-title">Ajustes</h4>
						</div>
						<div class="panel-body">
							<div class="table-responsive">
								<table id="data-table" class="table table-striped table-bordered">
									<thead>
										<tr>
											<th>Codigo</th>
											<th>Concepto</th>
											<th>Total</th>
											<th>Fecha</th>
											<th>Estado</th>
											<th>Acci√≥n</th>
										</tr>
									</thead>
									<tbody>
										{% for ajuste  in ajustes %}
											<tr>
												<td><a onclick="detalledeCompra({{ ajuste.0 }})"> {{ ajuste.1 }}</a></td>
												<td>{{ ajuste.19 | default_if_none:"" }}</td>
												<td>{{ ajuste.7 }}</td>
												<td>{{ ajuste.3 }}</td>

												<td>{% if ajuste.16 %}
												Aprobada
												{% elif ajuste.11 %}
														Anulada 
														{% else %}
														Esperando aprobacion
														{% endif %}
												</td>
												
												<td>
													{% if ajuste.16 %}
													{% else %}
													<a href="{% url 'ajustes-update' ajuste.0 %}">
														<button type="button" class="btn btn-info btn-xs"><i class="fa fa-cog"></i> Editar</button>								
													</a>
													{% endif %}
													<a href="{% url 'ajustes-imprimir' ajuste.0 %}">
														<button type="button" class="btn btn-info btn-xs"><i class="fa fa-cog"></i> Imprimir</button>								
													</a>

												</td>
											</tr >
										{% endfor %} 
									</tbody>
								</table>
							</div>

                            <h4 class="panel-title">Detalle de Ajustes</h4>
							<div class="table-responsive">
{#                                <table id="cab" class="table table-striped table-bordered">#}
{#									<thead>#}
{#										<tr>#}
{#											<th>Codigo</th>#}
{#											<th>Producto</th>#}
{#											<th>Cantidad</th>#}
{#											<th>Costo</th>#}
{#											<th>Total</th>#}
{#										</tr>#}
{#									</thead>#}
{#								</table>#}
								<table id="detalle" class="table table-striped table-bordered">
									<thead>
										<tr>
											<th>Codigo</th>
											<th>Producto</th>
											<th>Cantidad</th>
											<th>Costo</th>
											<th>Total</th>
										</tr>
									</thead>
									<tbody>

									</tbody>
								</table>
							</div>



						</div>
					</div>
					<!-- end panel -->

					<!-- #modal-dialog -->
					
				</div>
				<!-- end col-12 -->	
			
{% endblock %}

{% block javascript %}
{{ block.super }}

   
	<script type="text/javascript">

	function detalledeCompra(id){
		  $.ajax({
				url: "/config/obtenerDetalleAjuste/", // the endpoint
				type : "POST", // http method
				data : { id : id,'csrfmiddlewaretoken': '{{ csrf_token }}'},
				success:function(data){
				    $("#detalle").empty();
				    $("#detalle").append(data);
				},
				error: function(){

				},
			  });
	}

	</script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	{% if form.errors or form_mode == "update" %}
	<script type="text/javascript">
		$( document ).ready(function() {
			$(".modal").modal('toggle');
		});
	
	</script>
	{% endif %}
{% endblock %}
