{% extends "login/base-list.html" %}
{% load extra_filters %}

{% load staticfiles %}

{% block css %}
{{ block.super }}
{% endblock %}

{% block section_title %}Proforma Factura{% endblock %}
{% block section_subtitle %}
<br />
<div class="email-btn-row hidden-xs">
	<a href="{% url 'transacciones-register-proforma' %}" class="btn btn-sm btn-success"><i class="fa fa-plus m-r-5"></i> Nueva Proforma</a>
</div>
{% endblock %}

{% block content %}

<!-- begin col-12 -->
<div class="col-md-12">
	<!-- begin panel -->
	<div class="panel panel-inverse">
		<div class="panel-heading">
			<div class="panel-heading-btn">
				<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
				<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
			</div>
			<h4 class="panel-title"></h4>
		</div>
		<div class="panel-body">
			<div class="table-responsive">
				<table id="data-table" class="table table-striped table-bordered">
					<thead>
						<tr>
							<th>Registro Documento</th>
							<th>Tipo Documento</th>
							<th>Fecha</th>
							<th>Cliente</th>
							<th>Vendedor</th>
							<th>Vencimiento</th>
							<th>Estado</th>
							<th>Accion</th>
						</tr>
					</thead>
					<tbody>
						{% for proforma  in proformas %}
							<tr>
								<td> 
									{% if proforma.tipo_registro_documento == 1 %}
										Cliente
									{% else %}
										Proveedor
									{% endif %}
								</td>
								<td> 
									{% if proforma.tipo_documento == 1 %}
										Cotizaci√≥n
									{% else %}
										Prefactura
									{% endif %}
								</td>
								<td> {{ proforma.fecha }}</td>
								<td> {{ proforma.cliente.nombre_cliente }}</td>
								<td> {{ proforma.vendedor.nombre }}</td>
								<td> {{ proforma.vencimiento }}</td>
								<td>
									{% if proforma.activo %}
									Proforma deshabilitada
									{% else %}
									Proforma activa
									{% endif %}
								</td>
								<td>
									{% if proforma.anulada %}
										<a href="{% url 'transacciones-update-proforma' proforma.id %}">
											<button type="button" class="btn btn-info btn-xs"><i class="fa fa-cog"></i> Editar</button>								
										</a> 
									{% endif %}
								</td>
							</tr >
						{% endfor %} 
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<!-- end panel -->		
</div>
<!-- end col-12 -->	
{% endblock %}

{% block javascript %}
{{ block.super }}

	<script type="text/javascript">
		
	function detalledeCompra(id){
		$.ajax({
			url: "/config/obtenerDetalleCompra/", // the endpoint
			type : "POST", // http method
			data : { id : id,'csrfmiddlewaretoken': '{{ csrf_token }}'}, 
			success:function(data){
				$("#detalle tr").remove();
				$("#detalle").append(data);
			},
			error: function(){
			 
			},
		});
	}
	</script>
	
	{% if form.errors or form_mode == "update" %}
	<script type="text/javascript">
		$( document ).ready(function() {
			$(".modal").modal('toggle');
		});
	</script>

	{% endif %}

{% endblock %}