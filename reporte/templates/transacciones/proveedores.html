{% extends "login/base-list.html" %}
{% load extra_filters %}

{% load staticfiles %}

{% block css %}
{{ block.super }}
{% endblock %}


{% block section_title %}RANGO DE PROVEEDORES{% endblock %}
{% block content %}

    <!-- begin row -->

    <style>
        .panel-border {
            border: 1px solid #ddd !important
        }

        .form-ajust .form-group {
            margin-bottom: 0px !important
        }

        input[type="text"], select, input[type="number"] {
            border: 1px solid #ccd0d4;
            border-radius: 3px;
            box-shadow: none;
            font-size: 12px;
            height: 34px;
            padding: 6px 12px;
            line-height: 1.42857143;
            color: #555;
            background-color: #fff;
            background-image: none;
        }

        .table2 {
            width: 100%;
            max-width: 100%;
            margin-bottom: 20px;
            display: table
        }

        .table2 > tbody > tr > td, .table2 > tbody > tr > th, .table2 > tfoot > tr > td, .table2 > tfoot > tr > th {
            border-color: #e2e7eb;
            padding: 1px 0px;
        }

        .table2 > thead > tr > td, .table2 > thead > tr > th {
            border-color: #e2e7eb;
            padding: 10px 5px;
        }
        @media print {
  * {
    display: none;
  }
  #valor {
    display: block;
  }
}
    </style>


    <div id="busqueda_libro_diario">
        <div class="panel-heading">
            <form id="form_consulta_libro_diario" name='consulta_libro_diario' method="post"
                  class="form-horizontal">
                {% csrf_token %}
                <div class="panel panel-inverse">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a aria-expanded="true" class="accordion-toggle accordion-toggle-styled"
                               data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                <i class="fa fa-plus-circle pull-right"></i>
                                Busqueda
                            </a>
                        </h3>
                    </div>
                    <div id="collapseOne" aria-expanded="true" id="collapseOne" class="panel-collapse collapse in">
                        <div class="panel-body panel-border">
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="inputCuenta">Proveedor desde:</label>

                                <div class="col-sm-4" style="padding-right: 0px">
                                    <select id="proveedor" class="form-control" name="proveedor">
                                        <option value="0" selected>SELECCIONE PROVEEDOR</option>
                                        {% for p  in proveedores %}
                                            <option value="{{ p.1 }}">{{ p.1 }} - {{ p.2 }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                               
                                  <label class="col-sm-2 control-label" for="inputCentroCosto">Proveedor hasta:</label>

                                <div class="col-sm-4" style="padding-right: 0px">
                                     <select id="proveedor_hasta" class="form-control" name="proveedor_hasta">
                                        <option value="0" selected>SELECCIONE PROVEEDOR</option>
                                        {% for p  in proveedores %}
                                            <option value="{{ p.1 }}">{{ p.1 }} - {{ p.2 }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                            </div>
                            <div class="form-group">

                                <label class="col-sm-2 control-label" for="inputCentroCosto">Activo:</label>

                                <div class="col-sm-4" style="padding-right: 0px">
                                     <select id="activo" class="form-control" name="activo">
                                        <option value="0" selected>SELECCIONE</option>
                                        <option value="1" >SI</option>
                                        <option value="2" >NO</option>
                                        
                                    </select>
                                </div>
                                 <label class="col-sm-2 control-label" for="inputCentroCosto">Datos:</label>

                                <div class="col-sm-4" style="padding-right: 0px">
                                     <select id="datos" class="form-control" name="datos">
                                        <option value="0" selected>SELECCIONE</option>
                                        <option value="1" >CON</option>
                                        <option value="2" >SIN</option>
                                        
                                    </select>
                                </div>
                                
                       
                        </div>
                         <div class="col-sm-12" style="text-align: center">
                             
                                
                                <a class="default btn btn-link"  onclick="consultar()"> <button type="button" class="btn btn-primary btn-lg">  Consultar</button> </a>
                               <a class="btn btn-default buttons-copy buttons-html5" tabindex="0" aria-controls="tabla" download="balance_comprobacion.xls" href="#" onclick="return ExcellentExport.excel(this, 'tabla', 'Sheet Name Here');"><span>EXCEL</span></a>
                               <a class="btn btn-default buttons-copy buttons-html5" onclick="printDiv()">
    PDF
 </a>
                               
                               
                        <!--<a class="btn btn-default buttons-copy buttons-html5"  onclick="imprimir_pdf()">  PDF</a>
                          <a class="btn btn-default buttons-copy buttons-html5"  onclick="imprimir_pdf2()">  PDF2</a>
-->
                           


                                
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        <div class="panel panel-inverse">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <a aria-expanded="true" class="accordion-toggle accordion-toggle-styled"
                           data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                            <i class="fa fa-plus-circle pull-right"></i>
                        </a>
                    </h3>
                </div>
                <div id="collapseTwo" aria-expanded="true" id="collapseTwo" class="panel-collapse collapse in">
                    <div id="body_panel_libro_diario" class="panel-body panel-border">
                        <div class="table-responsive" id="valor">
                            <table  class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                   <th>Codigo</th>
											<th>Nombre</th>
											<th>Direccion</th>
											<th>Ruc</th>

											<th>Telefono</th>
												<th>Datos</th>
												<th>Activo</th>
                                </tr>
                                </thead>
                                <tbody>
                                
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<iframe name="print_frame" width="0" height="0" frameborder="0" src="about:blank"></iframe>



{% endblock %}

{% block javascript %}
    {{ block.super }}
    <script src=" https://printjs-4de6.kxcdn.com/print.min.js"></script>
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
-->
<!--  <script src="{% static 'color_admin/assets/js/exportFile.js' %}" type="text/javascript"></script>
-->
<script src="{% static 'color_admin/assets/js/script_autotable.js' %}"></script>

<script src="{% static 'color_admin/assets/js/excellentexport.js' %}" type="text/javascript"></script>

<script src="{% static 'color_admin/assets/js/tools.js' %}"></script>
    <script>

        	function consultar(){
		
		var proveedor=$("#proveedor").val();
		var proveedor_hasta=$("#proveedor_hasta").val();
        var activo=$("#activo").val();
        var datos=$("#datos").val();

add_div();
          $.ajax({
                url: "/reporte/obtenerRangoProveedores/", // the endpoint
                type : "POST", // http method
                data : { proveedor : proveedor,proveedor_hasta : proveedor_hasta,activo:activo,datos:datos,'csrfmiddlewaretoken': '{{ csrf_token }}'}, 
                success:function(data){
                //$("#tabla tbody tr").remove();
                 $("#div-consultando").remove();
                  $("#valor").html(data);
//				  
                },
                error: function(){
                 
                },
              });
    }

        $(document).ready(function () {
            $('#data-table-centro-costo').DataTable();
            $('#data-table-cuentas').DataTable();
            $('#data-table-libro-diario').DataTable();
            $('#estado-table').DataTable({dom: 'Brt',buttons: ['excel','pdf', 'print'],ordering: false,iDisplayLength: -1});


            $('#fecha_desde').datepicker({todayHighlight: true, autoclose: true,format: 'yyyy-mm-dd'});
            $('#fecha_hasta').datepicker({todayHighlight: true, autoclose: true,format: 'yyyy-mm-dd'});
            //$('#fecha_desde').val(getFechaHoy());
            //$('#fecha_hasta').val(getFechaHoy());


        
        });

     function add_div() {
            var div_externo = $('<div id="div-consultando" style="width: 100%; height: 100%; background-color: #191a1b; position: fixed; top: 0; right: 0; bottom: 0; left: 0; z-index: 1050; opacity: 0.8">');
            var div_interno = $('<div class="progress progress-striped active" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, 50%); width: 50%">');
            var progress = $('<div class="progress-bar progress-bar-inverse" style="width: 100%">Consultando...</div>');

            div_interno.append(progress);
            div_externo.append(div_interno);

            div_externo.appendTo($('body'));

        }

        function getFechaHoy() {
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth() + 1; //January is 0!
            var yyyy = today.getFullYear();

            if (dd < 10) {
                dd = '0' + dd
            }
            if (mm < 10) {
                mm = '0' + mm
            }
            today = dd + '/' + mm + '/' + yyyy;
            return today;
        }
function printDiv() {
         window.frames["print_frame"].document.body.innerHTML = document.getElementById("valor").innerHTML;
         window.frames["print_frame"].window.focus();
         window.frames["print_frame"].window.print();
       }
    </script>

{% endblock %}