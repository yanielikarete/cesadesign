{% extends "login/base_nuevo.html" %}

{% load staticfiles %}
{% load bootstrap3 %}
{% bootstrap_javascript %}


{% block css %}
{{ block.super }}
{% endblock %}

{% block section_title %}Inventario Nuevo -Contabilidad{% endblock %}
{% block section_subtitle %}
<br/>
<style type="text/css">
    table td {
        padding: 2px;
    }

    table th {
        padding: 2px;
    }
</style>
<div class="email-btn-row hidden-xs">
</div>

{% endblock %}

{% block content %}
<!-- begin col-12 -->
<div class="col-md-12">
    <!-- begin panel -->
    <div class="panel panel-inverse">
        <div class="panel-heading">
            <div class="panel-heading-btn">
                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i
                        class="fa fa-expand"></i></a>
                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i
                        class="fa fa-minus"></i></a>
            </div>
            <h4 class="panel-title">Reporte:</h4>
        </div>
        <div class="panel-body">
            <div class="table-responsive">
<div class="col-md-4">
                                                      <label for="exampleInputName2">Fecha hasta:</label>
                                                     <input  class="form-control" type="date" name="fechafin" id="fechafin" />

							</div>
                <div class="col-md-4">
                    <label for="exampleInputName2">Bodega</label>
                    <select name="bodega" id="bodega" class="form-control">

                        {% for c in bodega %}
                        <option value="{{c.id}}"> {{c.nombre}}
                            {% endfor %}
                    </select>

                </div>
                <div class="col-md-4">
                    <label for="exampleInputName2">Tipo</label>
                    <select name="tipos" id="tipos" class="form-control">
                        <option value="0">Seleccione</option>

                        {% for t in tipos %}
                        <option value="{{t.id}}"> {{t.descripcion}}</option>
                        {% endfor %}
                    </select>

                </div>
                <!--<div class="col-md-4">
                    <label for="exampleInputName2">Agrupado por Tipo Producto</label>
                    <input class="form-control" type="checkbox" name="producto" id="producto"/>

                </div>-->
		<div class="col-md-4">
                    <label for="exampleInputName2">Codigo Producto</label>
                    <input class="form-control" type="text" name="codigo" id="codigo"/>

                </div>
		<div class="col-md-4">
                    <label for="exampleInputName2">Nombre Producto</label>
                    <input class="form-control" type="text" name="nombre" id="nombre"/>

                </div>


                <a class="default btn btn-link" onclick="consultar()">
                    <button type="button" class="btn btn-primary btn-lg"> Consultar</button>
                </a>
                <a download="inventario.xls" href="#"
                   onclick="return ExcellentExport.excel(this, 'detalle', 'Inventario');">
                    <button type="button" class="btn btn-primary btn-lg"> Exportar</button>
                </a>

                <h2>Resultados</h2>
                <table id="detalle" class="table" border="1" aria-describedby="data-table_info">
                    <thead>
                    <tr>
                        <th>CÃ³digo</th>
                        <th>Producto</th>
                        <th>Tipo Producto</th>
			<th>Cantidad Inicial</th>
                        <th>Ingresos</th>
                        <th>Egresos</th>
                        <th>Existente</th>
                        <th>Valor Ingresos</th>
                                                 <th>Valor Egresos</th>

                        <th>Total</th>

                    </tr>
                    </thead>
                    <tbody></tbody>


                </table>

            </div>
        </div>

    </div>
    <!-- end col-12 -->

    {% endblock %}

    {% block javascript %}
    {{ block.super }}

<!--        <script src="{% static 'color_admin/assets/js/exportFile.js' %}" type="text/javascript"></script>
-->

<script src="{% static 'color_admin/assets/js/excellentexport.js' %}" type="text/javascript"></script>

    <script type="text/javascript">


        function consultar() {
            var bodega = $("#bodega").val();
            var tipos = $("#tipos").val();

            var fechafin = $("#fechafin").val();
            var producto = $("#producto").val();
	    var nombre = $("#nombre").val();
	    var codigo = $("#codigo").val();
            nombre=nombre.toUpperCase();
            if ($('#producto').prop('checked')) {
                producto = 'true';
            } else {
                producto = 'false';
            }
            if (producto == 'false') {
                $.ajax({
                    url: "/reporte/obtenerInventarioNuevoContable/", // the endpoint
                    type: "POST", // http method
                    data: {bodega: bodega, tipos: tipos,nombre: nombre,codigo: codigo,fechafin:fechafin, 'csrfmiddlewaretoken': '{{ csrf_token }}'},
                    success: function (data) {
                        $("#detalle tbody tr").remove();
                        $("#detalle").append(data);
                        $("#detalle").DataTable();


                    },
                    error: function () {

                    },
                });
            } else {
                $.ajax({
                    url: "/reporte/obtenerInventarioTipoProducto/", // the endpoint
                    type: "POST", // http method
                    data: {bodega: bodega, tipos: tipos,nombre: nombre,codigo: codigo, 'csrfmiddlewaretoken': '{{ csrf_token }}'},
                    success: function (data) {
                        $("#detalle tbody tr").remove();
                        $("#detalle").append(data);
                        $("#detalle").DataTable();
                    },
                    error: function () {

                    },
                });
            }
        }
    </script>
    <!-- ================== END PAGE LEVEL JS ================== -->
    {% if form.errors or form_mode == "update" %}
    <script type="text/javascript">
        $(document).ready(function () {
            $(".modal").modal('toggle');
        });

    </script>
    {% endif %}
    {% endblock %}

