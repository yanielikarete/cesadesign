{% extends "login/base-list.html" %}
{% load extra_filters %}

{% load staticfiles %}


{% block css %}
{{ block.super }}
{% endblock %}

{% block section_title %}Kardex Nuevo{% endblock %}
{% block section_subtitle %}
<br/>
<style type="text/css">
    table td {
        padding: 2px;
    }

    table th {
        padding: 2px;
    }
</style>
<div class="email-btn-row hidden-xs">
</div>

{% endblock %}

{% block content %}
<!-- begin col-12 -->
<div class="col-md-12">
    <!-- begin panel -->
    <div class="panel panel-inverse">
        <div class="panel-heading">
            <div class="panel-heading-btn">
                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i
                        class="fa fa-expand"></i></a>
                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i
                        class="fa fa-minus"></i></a>
            </div>
            <h4 class="panel-title">Reportes:</h4>
        </div>
        <div class="panel-body">
            <div class="table-responsive">
	<!--<div class="col-md-4">
                                                      <label for="exampleInputName2">Fecha desde:</label>
                                                     <input  class="form-control" type="date" name="fechainicial" id="fechainicial" />

							</div>-->

<div class="col-md-4">
                                                      <label for="exampleInputName2">Fecha hasta:</label>
                                                     <input  class="form-control" type="date" name="fechafin" id="fechafin" />

							</div>
                <div class="col-md-4">
                    <label for="exampleInputName2">Bodega</label>
                    <select name="bodega" id="bodega" class="form-control">

                        {% for c in bodega %}
                        <option value="{{c.id}}"> {{c.nombre}}
                            {% endfor %}
                    </select>

                </div>


		<div class="col-md-4">
                    <label for="exampleInputName2">Codigo Producto</label>
                    <input class="form-control" type="text" name="codigo" id="codigo"/>

                </div>
		<div class="col-md-4">
                    <label for="exampleInputName2">Nombre Producto</label>
                    <input class="form-control" type="text" name="nombre" id="nombre"/>

                </div>


                <a class="default btn btn-link" onclick="consultar()">
                    <button type="button" class="btn btn-primary btn-lg"> Consultar</button>
                </a>
                <a download="inventario.xls" href="#"
                   onclick="return ExcellentExport.excel(this, 'detalle', 'Inventario');">
                    <button type="button" class="btn btn-primary btn-lg"> Exportar</button>
                </a>

                <h2>Resultados</h2>
                <table id="detalle" class="table" border="1" aria-describedby="data-table_info">
                    <thead>
                    <tr>
                         <th>Fecha</th>
                        <th>CÃ³digo</th>
                        <th>Producto</th>
                        <th>Bodega</th>
                        <th>Descripcion</th>
                        <!--<th>Cantidad Max.</th>
                        <th>Cantidad Min.</th>-->
                        <th>Entrada</th>
                         <th>Salida</th>
                         <th>Saldo Actual</th>


                        <th>Existencia</th>

                    </tr>
                    </thead>
                    <tbody></tbody>


                </table>

            </div>
        </div>

    </div>
    <!-- end col-12 -->

    {% endblock %}

    {% block javascript %}
    {{ block.super }}

<!--        <script src="{% static 'color_admin/assets/js/exportFile.js' %}" type="text/javascript"></script>
-->
<script src="{% static 'color_admin/assets/js/excellentexport.js' %}" type="text/javascript"></script>

    <script type="text/javascript">


        function consultar() {
            var bodega = $("#bodega").val();

	    var nombre = $("#nombre").val();
	    var codigo = $("#codigo").val();
            var fechainicial = $("#fechainicial").val();
	    var fechafin = $("#fechafin").val();
            nombre=nombre.toUpperCase();
            if ($('#producto').prop('checked')) {
                producto = 'true';
            } else {
                producto = 'false';
            }
            if (producto == 'false') {
                $.ajax({
                    url: "/reporte/obtenerKardexNuevo/", // the endpoint
                    type: "POST", // http method
                    data: {bodega: bodega,nombre: nombre,codigo: codigo,fechainicial:fechainicial,fechafin:fechafin, 'csrfmiddlewaretoken': '{{ csrf_token }}'},
                    success: function (data) {
                        $("#detalle tbody tr").remove();
                        $("#detalle").append(data);
                    },
                    error: function () {

                    },
                });
            } else {
                $.ajax({
                    url: "/reporte/obtenerInventarioTipoProducto/", // the endpoint
                    type: "POST", // http method
                    data: {bodega: bodega, tipos: tipos,nombre: nombre,codigo: codigo, 'csrfmiddlewaretoken': '{{ csrf_token }}'},
                    success: function (data) {
                        $("#detalle tbody tr").remove();
                        $("#detalle").append(data);
                    },
                    error: function () {

                    },
                });
            }
        }
    </script>
    <!-- ================== END PAGE LEVEL JS ================== -->
    {% if form.errors or form_mode == "update" %}
    <script type="text/javascript">
        $(document).ready(function () {
            $(".modal").modal('toggle');
        });

    </script>
    {% endif %}
    {% endblock %}

