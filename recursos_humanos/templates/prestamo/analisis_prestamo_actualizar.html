{% extends "login/base_nuevo.html" %}
{% load staticfiles %}

{# Load the tag library #}
{% load bootstrap3 %}

{# Load CSS and JavaScript #}
{% bootstrap_javascript %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block css %}
{{ block.super }}
    <!-- ================== BEGIN PAGE LEVEL STYLE ================== -->
    <link href="{% static 'color_admin/assets/plugins/bootstrap-wizard/css/bwizard.min.css' %}" rel="stylesheet" />
    <!-- ================== END PAGE LEVEL STYLE ================== -->
{% endblock %}

{% block section_title %}Prestamo{% endblock %}
{% block section_subtitle %}Por favor diligencie el siguiente formulario
{% endblock %}

{% block content %}

  <style>
       .panel-border{border: 1px solid #ddd !important}
       .form-ajust .form-group{margin-bottom: 0px !important}
      input[type="text"],select,input[type="number"]
      {

    border: 1px solid #ccd0d4;
    border-radius: 3px;
    box-shadow: none;
    font-size: 12px;
    display: block;
    width: 100%;
    height: 34px;
    padding: 6px 12px;
    line-height: 1.42857143;
    color: #555;
    background-color: #fff;
    background-image: none;
       }



    </style>
    {% if mensaje %}
    <div class="alert alert-success alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert"></button>
                        {{ mensaje }}

                    </div>
     {% else %}
     {% endif %}
     <form method="post" data-parsley-validate="true" name="form-wizard" enctype="multipart/form-data"> {% csrf_token %}
            <!-- begin row -->
          <div class="row">
  <div class="col-md-12">
                        <div class="panel panel-default panel-border">
                            <div class="panel-heading">Documento</div>
                            <div class="panel-body">

                            <div class="col-md-3">
                              <label for="exampleInputName2">Codigo</label>
                               {% bootstrap_field form.codigo show_label=False %}

                            </div>
                            <div class="col-md-6">
                              <label for="exampleInputName2">Empleado</label>
                               {% bootstrap_field form.empleado show_label=False %}

                            </div>
                            <div class="col-md-6">
                              <label for="exampleInputName2">Concepto</label>
                               {% bootstrap_field form.concepto show_label=False %}

                            </div>
                             <div class="col-md-6">
                              <label for="exampleInputName2">Valor Mensual</label>
                              <div class="form-group">
                                <input type="text" class="form-control" id="valor_mensual" name="valor_mensual" value="{{ form.valor_mensual.value }}"/>
</div>
                            </div>
                             <div class="col-md-6">
                              <label for="exampleInputName2">Tipo</label>
                               {% bootstrap_field form.tipo_ingreso_egreso_empleado show_label=False %}

                            </div>
                             <div class="col-md-6">
                              <label for="exampleInputName2">Plazo(meses)</label>
                               {% bootstrap_field form.plazos show_label=False %}

                            </div>
                               <div class="col-md-6">
                              <label for="exampleInputEmail2">Fecha Emision</label>
                                                    {% bootstrap_field form.fecha  show_label=False%}
   </div>
                              <div class="col-md-6">
                              <label for="exampleInputName2">Valor Total</label>
                                                            <div class="form-group">

<input type="text" class="form-control" id="total" name="total" value="{{ form.total.value }}"/>
                            </div>
                                                        </div>

                             <div class="col-md-6">
                              <label for="exampleInputEmail2">Descripcion</label>
                                                    {% bootstrap_field form.descripcion  show_label=False%}
   </div>







                            </div>
                        </div>
                        </div>
        </div

   <p class="text-center">

                                    <button type="submit" class="btn btn-primary btn-lg"><i class="fa fa-cog"></i> Guardar</button>
                                            <a class="default btn btn-link" href="/recursos_humanos/prestamo/"><button type="button" class="btn btn-primary btn-lg">  Regresar</button></a>
                                        </p>


                            </form>

{% endblock %}

{% block javascript %}
{{ block.super }}
<!-- ================== BEGIN PAGE LEVEL JS ================== -->
<script src="{% static 'color_admin/assets/plugins/parsley/dist/parsley.js' %}"></script>
<script src="{% static 'color_admin/assets/plugins/bootstrap-wizard/js/bwizard.js' %}"></script>
<script src="{% static 'color_admin/assets/js/apps.min.js' %}"></script>
<script src="{% static 'color_admin/assets/plugins/DataTables-1.9.4/js/jquery.dataTables.js' %}"></script>
<script src="{% static 'color_admin/assets/plugins/DataTables-1.9.4/js/data-table.js' %}"></script>

<!-- ================== END PAGE LEVEL JS ================== -->
<script>
  $(document).ready(function() {
    // App.init();
    $('#tabla2').DataTable();

    //FormWizardValidation.init();
  });
</script>
<script>
    $(document).ready(function() {
      $('#id_codigo').attr('readonly','readonly');
       $('#total').attr('readonly','readonly');
        var costo=$('#valor_mensual').val();
        var total=$('#total').val();
        $('#valor_mensual').val(costo.toString().replace(/\,/g,'.'));
        $('#total').val(total.toString().replace(/\,/g,'.'));
$( "#valor_mensual" ).keyup(function() {
    actualizarValor();
});
$( "#id_plazos" ).keyup(function() {
    actualizarValor();
});
            $('#id_fecha').datepicker({todayHighlight:true,autoclose:true});

    });

</script>
<script>


    function actualizarValor(){
      var plazo=$('#id_plazos').val();
      var valor=$('#valor_mensual').val();
      var total=0;
      total=valor*plazo;

             $("#total").val(total);
    }

</script>
<script type="text/javascript">
    $(document).ready(function(){
        /**
         */
          $("#add").click(function(){
            // (tr) del id "tabla"
            var num_recetas=$('#columnas_receta').val();
            num_recetas=parseInt(num_recetas)+1;

            var tds=$("#tabla tr:first td").length;
            // Obtenemos el total de columnas (tr) del id "tabla"
            var trs=$("#tabla tr").length;
            var nuevaFila='<tr><td  class="eliminar"><a class="btn btn-danger remove_fields "><i class=" glyphicon glyphicon-trash icon-white"></i></a></td>';
                nuevaFila+='<td><input type="hidden" class="form-control" id="id_kits'+num_recetas+'" name="id_kits'+num_recetas+'"> ';
                nuevaFila+='<input type="text" required="required" class="form-control" id="codigo_kits'+num_recetas+'" name="codigo_kits'+num_recetas+'" onfocus="mostrarProductos('+num_recetas+')" readonly="readonly"></td>';
                 nuevaFila+='<td><span  id="nombre_kits'+num_recetas+'" name="nombre_kits'+num_recetas+'" ></span></td>';
                   nuevaFila+='<td><input type="text" class="form-control" id="medida_kits'+num_recetas+'" name="medida_kits'+num_recetas+'" readonly="readonly"></td>';
                nuevaFila+='<td><input type="text" class="form-control" required="required" id="cantidad_kits'+num_recetas+'" name="cantidad_kits'+num_recetas+'" onkeyup="actualizarCosto('+num_recetas+')"></td>';

                nuevaFila+='<td><input type="text" class="form-control" id="costo_kits'+num_recetas+'" name="costo_kits'+num_recetas+'" onkeyup="actualizarCosto('+num_recetas+')" required="required"></td>';
                nuevaFila+='<td><input type="text" class="form-control" id="total_kits'+num_recetas+'" name="total_kits'+num_recetas+'" readonly="readonly"></td>';
                nuevaFila+='</tr>';

              $('#columnas_receta').val(num_recetas);

            $("#tabla").append(nuevaFila);
        });

        /**
         * Funcion para eliminar la ultima columna de la tabla.
         * Si unicamente queda una columna, esta no sera eliminada
         */
        $("#del").click(function(){
            // Obtenemos el total de columnas (tr) del id "tabla"
            var trs=$("#tabla tr").length;
            if(trs>1)
            {
                // Eliminamos la ultima columna
                $("#tabla tr:last").remove();
            }
             actualizarTotal();
        });


        $(document).on("click",".eliminar",function(){
            var parent = $(this).parent();
  $(parent).remove();
   actualizarTotal();

          });



    });

    </script>
{% endblock %}                                                                                                                                                                                                                                                                