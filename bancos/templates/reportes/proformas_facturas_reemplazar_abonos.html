{% extends "login/base-list.html" %}
{% load extra_filters %}
{% load staticfiles %}

{% block css %}
    {{ block.super }}
{% endblock %}

{% block section_title %}

{% endblock %}

{% block section_subtitle %}
    <br />
    <div class="email-btn-row hidden-xs">
        
    </div>
{% endblock %}

{% block content %}
<style>
	.btn {
    padding: 6px 6px !important;}
  
          .bold-option{font-weight: bolder;}

</style>
    <!-- begin col-12 -->
    <div class="col-md-12">
        <!-- begin panel -->
        <div class="panel panel-inverse">
            <div class="panel-heading">
                <div class="panel-heading-btn">
                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand">
                        <i class="fa fa-expand"></i>
                    </a>
                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse">
                        <i class="fa fa-minus"></i>
                    </a>
                </div>
                <h4 class="panel-title">Movimientos Abonados </h4>
            </div>
            <div class="panel-body">
                <div class="table-responsive">
					
                    <table id="data-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Fecha</th>
								<td>Cliente</td>
                                <th>Comprobante</th>
                                <th>Abono</th>
								 <th>Accion</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for a  in abonos %}
                            <tr>
                                <td>{{a.movimiento.tipo_documento}}</td>
                                <td>{{a.movimiento.fecha_emision }}</td>
                                <td>{{a.movimiento.paguese_a }}</td>
								 <td>{{a.movimiento.numero_comprobante}}</td>
                                <td>{{a.abono}}</td>
								 <td>
                                    <a href="#" onclick="mostrar_ad({{a.id}})">Modificar</a>
                                </td>
                            </tr >
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- end panel -->
        <!-- #modal-dialog -->
    </div>
		<div aria-hidden="true" style="display: none;"  id="dlgIngreso" class="modal fade">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <button type="button" class="close" data-dismiss="modal">Ã—</button>
                    <h4 id="id_popup_ingresos" class="modal-title"></h4>
                </div>
                <div class="modal-body">
                   <input type="hidden" id="tipo_ingreso_id" name="tipo_ingreso" value="" />
                   <div id="contenido_dlgIngreso">
                       <div class="indicator show"><span class="spinner spinner16"></span></div>
                   </div>
                </div>
            </div>
        </div>
    </div>


    <!-- end col-12 -->
{% endblock %}

{% block javascript %}
    {{ block.super }}

	<script type="text/javascript">
		
		function mostrar_ad(prefix){
   
      var parametros = {
                'id': prefix,
                'proforma_id': {{proforma_id}},
                'csrfmiddlewaretoken': '{{ csrf_token }}'

            }
           
        $("#id_popup_ingresos").html("<b>Abonar a las siguientes facturas</b>");
    
       $.ajax({
                    url: "/bancos/mostrar_proformas_abonos_facturas/",
                    type: "POST",
                    async: true,
                    data: parametros,
                    success: function(data){
                        $('#contenido_dlgIngreso').html(data);
                    },
                    complete: function(){
                       $("#btn_guardar_ingresos").show();
                    }
                });




            $('#dlgIngreso').modal();
            

        }
         
		 
        function detalledeCompra(id){
            $.ajax({
                url: "/config/obtenerDetalleCompra/", // the endpoint
                type : "POST", // http method
                data : { id : id,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                success:function(data){
                    $("#detalle tr").remove();
                    $("#detalle").append(data);
                },
                error: function(){

                },
            });
        }
	</script>

	{% if form.errors or form_mode == "update" %}
	<script type="text/javascript">
		$( document ).ready(function() {
		    $(".modal").modal('toggle');
		});
	</script>
	{% endif %}

{% endblock %}



