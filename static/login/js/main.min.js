var files;$(document).ready(function(){offCanvas();$(window).on("scroll",function(){isActionFixed();});$(".btn-modal-ajax").on("click",function(){modalAjax(this);
});menuCollapsed();$(document).on("click","a.print-data",function(){printTableData();return false;});$("a, abbr, button").tooltip();$("select:not(.template-email)").chosen({allow_single_deselect:true,width:"100%"});
$("input[name*='fecha']").datetimepicker({language:"es",pickTime:false,});$("input[name*='date'], input[name*='_at']").datetimepicker({language:"es",});
isActionFixed();actionCheckbox();});function offCanvas(){$("[data-toggle=offcanvas]").click(function(){$(".row-offcanvas").toggleClass("active");$(this).toggleClass("active");
});if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){$(".row-offcanvas").removeClass("active");}}function menuCollapsed(){$("#nav-left li.accordion-toggle").each(function(b){var a=$(this).find("ul.nav");
var c=$(this).find("ul.nav li.active");if(c.length==1){$(a).addClass("in");$(this).addClass("active");toggleArrow(this,"fa-angle-down","fa-angle-right");
}});$(".accordion-toggle").on("hidden.bs.collapse",function(){toggleArrow(this,"fa-angle-right","fa-angle-down");});$(".accordion-toggle").on("show.bs.collapse",function(){toggleArrow(this,"fa-angle-down","fa-angle-right");
});}function notificaciones(a,b){$(document).on("shown.bs.popover","#notificaciones-user",function(){getNotificaciones(a);});$(".popover-notificaciones").popover({animation:true,title:"",html:true,trigger:"click",content:"<ul class='notificaciones-list fsm'><li class='text-center'><img src='"+b+"' /></li></ul>"});
}function printTableData(){var a="<head>"+$("head").html()+"</head>"+$(".col-main").html();var b=window.open("");b.document.write(a);b.print();b.close();
}function toggleArrow(c,b,a){$(c).find(".arrow-collapse").removeClass(a).addClass(b);}function isActionFixed(){var b=$(window).scrollTop();var a=$(window).height();
if($("#form-actions").offset()){var c=$("#form-actions").offset().top;if((a+b)>=c){$("#form-actions .form-actions").removeClass("form-actions-fixed");}else{$("#form-actions .form-actions").addClass("form-actions-fixed");
}}}function isHeadFixed(){var b=$(window).scrollTop();if($("#navigation").offset()){var a=$("#navigation").offset().top+$("#navigation").height();if(a>=b){$(".page-head").removeClass("container head-fixed");
$(".page-content").css("top","0px");}else{$(".page-head").addClass("container head-fixed");$(".page-content").css("top",$(".page-head").height()+15);}}}function actionCheckbox(){var a=$(".table tr td.action-checkbox input:checked").length;
$(".table tr td.action-checkbox input").on("change",function(){checkRow(this);});$(".table #action-toggle input").on("click",function(){var b=$(this).is(":checked");
$(".table tr td.action-checkbox input").each(function(){if(b){this.checked=true;checkRow(this);}else{this.checked=false;checkRow(this);}});});}function checkRow(a){if($(a).is(":checked")){$(a).closest("tr").addClass("warning");
}else{$(a).closest("tr").removeClass("warning");}num_selected=$(".table tr td.action-checkbox input:checked").length;if(num_selected<=0){num_selected="";
$(".form-actions .btn").addClass("disabled");}else{$(".form-actions .btn").removeClass("disabled");}$(".num_select").text(num_selected);}function actionFormList(b,a){if(a){$("#form-list").attr("target","_black");
}$("#form-list").attr("action",b);$("#form-list").submit();}function modalAjax(a){var b="#"+$(a).data("forId");$("#modal-add #title").html($(a).data("originalTitle"));
$("#modal-add .modal-body").html("");$("#modal-add .modal-body").load($(a).data("forUrl"),function(){$(".btn-ajax-form").off("click");$(".btn-ajax-form").on("click",function(){sendFormAjax(b);
});});}function sendFormAjax(b){var a=b;$(".ajax-form").submit(function(f){f.preventDefault();var c=$(this).serializeArray();var d=$(this).attr("action");
$(".btn-ajax-form").attr("disabled",true);$.ajax({url:d,type:"POST",data:c,success:function(h,j,g){try{obj=JSON.parse(h);$(a).append($("<option>",{value:obj.value,text:obj.text,selected:"selected"}));
$(a).trigger("chosen:updated");$("#modal-add").modal("hide");}catch(i){$("#modal-add .modal-body").html(h);}$(".btn-ajax-form").attr("disabled",false);
},error:function(e,h,g){alert("Ocurrio un Error Vuelva a Intentarlo");$(".btn-ajax-form").attr("disabled",false);}});});$(".ajax-form").submit();}function notaAjax(){$("#form-notas").submit(function(c){c.preventDefault();
var a=$(this).serializeArray();var b=$(this).attr("action");$("#form-notas .btn-ajax-form").attr("disabled",true);$("#form-notas .loader-ajax-form").css("display","inline");
$.ajax({url:b,type:"POST",data:a,success:function(f,h,d){try{obj=JSON.parse(f);$("#table-notas tbody").prepend($('<tr id="row-'+obj.value+'"><td><a onclick="if(confirm(\'Confirmar Eliminaciones\')){eliminarFila(this)};return false;" href="/contactos/nota/'+obj.value+'/eliminar/" title="Eliminar" data-id="'+obj.value+'" class="print-no pull-right"><i class="fa fa-trash-o"></i></a>'+obj.nota+'<div class="fsm fcg"><i class="flg fa fa-clock-o"></i> '+obj.date+" Autor: "+obj.user+"</div></td></tr>"));
$("#id_nota").val("");}catch(g){console.log(g);console.log(f);}},error:function(d,f,e){alert("Ocurrio un Error Vuelva a Intentarlo");},complete:function(){$("#form-notas .btn-ajax-form").attr("disabled",false);
$("#form-notas .loader-ajax-form").css("display","none");},});});}function docAjax(){$("#form-file-doc").submit(function(c){c.stopPropagation();c.preventDefault();
var b=new FormData(c.target);var a=$(this).attr("action");$("#form-file-doc .btn-ajax-form").attr("disabled",true);$("#form-file-doc .loader-ajax-form").css("display","inline");
$.ajax({url:a,type:"POST",data:b,dataType:"json",processData:false,contentType:false,success:function(e,f,d){$("#clear_file").trigger("click");$("#table-doc tbody").prepend($('<tr id="row-'+e.value+'"><td><a onclick="if(confirm(\'Confirmar Eliminaciones\')){eliminarFila(this)};return false;" href="/contactos/documento/'+e.value+'/eliminar/" title="Eliminar" data-id="'+e.value+'" class="print-no pull-right"><i class="fa fa-trash-o"></i></a><a href="'+e.url+'" title="Descargar" target="_black">'+e.doc+'</a><div class="fsm fcg"><i class="flg fa fa-clock-o"></i> '+e.date+" Autor: "+e.user+"</div></td></tr>"));
$("#form-file-doc .btn-ajax-form").attr("disabled",false);},error:function(d,f,e){alert("Ocurrio un Error Vuelva a Intentarlo");},complete:function(){$("#form-file-doc .btn-ajax-form").attr("disabled",false);
$("#form-file-doc .loader-ajax-form").css("display","none");},});});}function eliminarFila(c){var b=$(c).attr("href");var a=$(c).data("id");$.ajax({url:b,success:function(){$("#row-"+a).hide("slow");
$("#row-"+a).remove();},error:function(){alert("Ocurrio un Error Vuelva a Intentarlo");}});return false;}function activarDesactivarFila(e,b){var f=$(e);
var c=f.attr("href");var a=f.data("id");var d="/static/admin/img/icon-yes.gif";$.ajax({url:c,success:function(){var g=$("#row-"+a);g.find("#activar-user").toggleClass("hidden");
g.find("#desactivar-user").toggleClass("hidden");if(b){alert("Usuario Activado");}else{alert("Usuario Desactivado");d="/static/admin/img/icon-no.gif";}g.find(".is_active img").attr("src",d);
},error:function(){alert("Ocurrio un Error Vuelva a Intentarlo");}});return false;}function getTemplateEmailAjax(b,a,c){$.ajax({url:b,type:"GET",data:{id:c},success:function(e,f,d){$("#bodyMailer").val(e);
$("#bodyMailer").cleditor()[0].updateFrame();},error:function(d,f,e){alert("Ocurrio un Error Vuelva a Intentarlo");}});}function colorBg(){}function changeColor(a){$.cookie("color",a);
colorBg();}function today(){var e=new Date();var c=e.getMonth()+1;var b=e.getDate();var a=((""+b).length<2?"0":"")+b+"/"+((""+c).length<2?"0":"")+c+"/"+e.getFullYear();
return a;}function getNotificaciones(a){var b="";$("ul.notificaciones-list").parent().addClass("notificaciones-content");$.getJSON(a,function(c){$.each(c,function(){b+='<li class="clearfix"><a class="clearfix" target="_black" href="'+this.url+'" ><div><span><strong>'+this.title+"</strong> "+this.subtitle+"</span></div><div class='time'><span class='pull-right timestamp'>"+moment(this.date).startOf("day").fromNow()+"</span></div></a></li>";
});}).error(function(){b="<li>Error al Cargar los Datos</li>";}).complete(function(){$(".popover ul.notificaciones-list").html(b);$("#notificaciones-count").text("");
});}function cargarMas(){$(".cargar-mas").on("click",function(g){g.preventDefault();var b=$(this);var d=b.attr("href");var c=b.data("row");var h=b.data("id");
var a=true;d+="?page="+c;var f=b.parent().find(".loader-ajax-form");f.css("display","inline");$.getJSON(d,function(i){var j=i[0].data;var e=i[0].type;a=i[0].pagination;
$.each(j,function(){if(e=="nota"){$("#table-notas tbody").append($('<tr id="row-'+this.value+'"><td><a  onclick="if(confirm(\'Confirmar Eliminaciones\')){eliminarFila(this)};return false;" href="/contactos/nota/'+this.value+'/eliminar/" title="Eliminar" data-id="'+this.value+'" class="print-no pull-right"><i class="fa fa-trash-o"></i></a>'+this.nota+'<div class="fsm fcg"><i class="flg fa fa-clock-o"></i> '+moment(this.date).format("D [de] MMMM [de] YYYY [a las] mm:HH")+" Autor: "+this.user+"</div></td></tr>"));
}else{$("#table-doc tbody").append($('<tr id="row-'+i.value+'"><td><a onclick="if(confirm(\'Confirmar Eliminaciones\')){eliminarFila(this)};return false;" href="/contactos/documento/'+this.value+'/eliminar/" title="Eliminar" data-id="'+this.value+'" class="print-no pull-right"><i class="fa fa-trash-o"></i></a><a href="'+this.url+'" title="Descargar" target="_black">'+this.doc+'</a><div class="fsm fcg"><i class="flg fa fa-clock-o"></i> '+moment(this.date).format("D [de] MMMM [de] YYYY [a las] mm:HH")+" Autor: "+this.user+"</div></td></tr>"));
}});b.data("row",c+1);if(!a){b.css("display","none");}}).error(function(){alert("Ocurrio un Error Vuelva a Intentarlo");}).complete(function(){f.css("display","none");
});});}function cargarJsContactosDetalle(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){if($(a.target).attr("href")=="#direccion"){google.maps.event.trigger(map,"resize");
if(marker){map.setCenter(marker.getPosition());}}});notaAjax();cargarMas();docAjax();$("#id_nota").on("keyup",function(){if($(this).val()==""){$("#form-notas .btn-ajax-form").addClass("disabled");
}else{$("#form-notas .btn-ajax-form").removeClass("disabled");}});$("input[type=file]").bootstrapFileInput();}function cargarJsMailer(){$("#bodyMailer").cleditor({height:530,controls:"bold italic underline strikethrough subscript superscript | font size style | color highlight removeformat | bullets numbering | outdent indent | alignleft center alignright justify | undo redo | rule image link unlink | source",});
$("input[type=file]").bootstrapFileInput();$(".toolbar li").tooltip();}function cargarJsActividades(){$(".popover-info").popover({animation:true,html:true,trigger:"hover",});
$("#id_date_start").on("change.dp",function(a){$("#id_date_end").data("DateTimePicker").setStartDate(a.date);});$("#id_date_end").on("change.dp",function(a){$("#id_date_start").data("DateTimePicker").setEndDate(a.date);
});$(".btn-today").on("click",function(){$("#id_fecha_limite").val(today());});$("#select-prospecto").on("change",function(){$("#id_cliente_chosen").css("display","none");
$("#id_empresa_chosen").css("display","none");$("#id_prospecto_chosen").css("display","block");});$("#select-cliente").on("change",function(){$("#id_prospecto_chosen").css("display","none");
$("#id_empresa_chosen").css("display","none");$("#id_cliente_chosen").css("display","block");});$("#select-empresa").on("change",function(){$("#id_cliente_chosen").css("display","none");
$("#id_prospecto_chosen").css("display","none");$("#id_empresa_chosen").css("display","block");});$("#id_cliente_chosen").css("display","none");$("#id_empresa_chosen").css("display","none");
}